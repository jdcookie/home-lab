---
services:
  jellyfin:
    image: jellyfin/jellyfin:latest
    container_name: jellyfin
    restart: unless-stopped
    user: 1000:1000  # UPDATE with your user:group ID
    environment:
      - TZ=${TZ:-America/New_York}
      - JELLYFIN_PublishedServerUrl=${JELLYFIN_URL:-http://jellyfin.home.lab}
    volumes:
      - ./config:/config
      - ./cache:/cache
      - ${MEDIA_PATH:-/mnt/media}:/media:ro  # UPDATE with your media path
    ports:
      - "8096:8096"
      - "8920:8920"  # HTTPS (optional)
      - "7359:7359/udp"  # Auto-discovery (optional)
      - "1900:1900/udp"  # DLNA (optional)
    # Hardware acceleration devices (uncomment if available)
    # devices:
    #   # Intel QuickSync
    #   - /dev/dri/renderD128:/dev/dri/renderD128
    #   - /dev/dri/card0:/dev/dri/card0
    #   # NVIDIA
    #   - /dev/nvidia0:/dev/nvidia0
    #   - /dev/nvidiactl:/dev/nvidiactl
    networks:
      - homelab

networks:
  homelab:
    external: true
    name: homelab
