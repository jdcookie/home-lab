---
# Global variables for all hosts
# These can be overridden by environment variables - see .env.example

# Domain configuration
homelab_domain: "{{ lookup('pipe', 'grep ^HOMELAB_DOMAIN= ../../.env | cut -d= -f2') | default('lab.example.com', true) }}"
base_domain: "{{ lookup('pipe', 'grep ^BASE_DOMAIN= ../../.env | cut -d= -f2') | default('example.com', true) }}"

# Network configuration
homelab_network: "{{ lookup('pipe', 'grep ^NETWORK_CIDR= ../../.env | cut -d= -f2') | default('192.168.1.0/24', true) }}"
homelab_gateway: "{{ lookup('pipe', 'grep ^GATEWAY_IP= ../../.env | cut -d= -f2') | default('192.168.1.1', true) }}"
homelab_dns_primary: "{{ lookup('pipe', 'grep ^PIHOLE_IP= ../../.env | cut -d= -f2') | default('192.168.1.10', true) }}"
homelab_dns_secondary: "1.1.1.1"

# Timezone
timezone: "{{ lookup('pipe', 'grep ^TIMEZONE= ../../.env | cut -d= -f2') | default('America/New_York', true) }}"

# Docker configuration
docker_version: "latest"
docker_compose_version: "2.23.0"

# Service URLs (automatically built from homelab_domain)
pihole_url: "pihole.{{ homelab_domain }}"
caddy_url: "proxy.{{ homelab_domain }}"
authentik_url: "auth.{{ homelab_domain }}"
jellyfin_url: "jellyfin.{{ homelab_domain }}"
n8n_url: "n8n.{{ homelab_domain }}"
portainer_url: "portainer.{{ homelab_domain }}"
uptime_url: "status.{{ homelab_domain }}"

# Future services (deployment disabled, but URL defined for templates)
immich_url: "immich.{{ homelab_domain }}"

# Paths
homelab_repo_path: "/opt/homelab"
compose_base_path: "/opt/homelab/compose"
backup_path: "/opt/backups"

# Backup configuration
backup_retention_days: 30
backup_schedule: "0 2 * * *"  # Daily at 2 AM

# Let's Encrypt configuration
letsencrypt_email: "{{ lookup('pipe', 'grep ^ADMIN_EMAIL= ../../.env | cut -d= -f2') | default('admin@example.com', true) }}"

# DNS API credentials (for Let's Encrypt DNS challenge)
dns_api_key: "{{ lookup('pipe', 'grep ^DNS_API_KEY= ../../.env | cut -d= -f2') | default('', true) }}"
dns_secret_key: "{{ lookup('pipe', 'grep ^DNS_SECRET_KEY= ../../.env | cut -d= -f2') | default('', true) }}"
