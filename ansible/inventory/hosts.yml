---
all:
  children:
    proxmox:
      hosts:
        pve:
          ansible_host: "{{ lookup('pipe', 'grep ^PROXMOX_IP= ../../.env | cut -d= -f2') | default('192.168.1.2', true) }}"
          ansible_user: root
          ansible_python_interpreter: /usr/bin/python3

    lxc_containers:
      hosts:
        pihole:
          # MIGRATION: Temporarily pointing to Raspberry Pi
          # Old LXC was: 192.168.1.10, root user
          # After cutover, update IP to 192.168.1.10 and remove this comment
          ansible_host: 192.168.1.176
          ansible_user: jcook
          ansible_become: true
          ansible_connection: ssh
          device_type: raspberry_pi
          # Old LXC settings (kept for reference):
          # lxc_id: 100
          # lxc_template: debian-12-standard
          # lxc_storage: local-lvm
          # lxc_memory: 512
          # lxc_cores: 1
          # lxc_disk_size: 8

        caddy:
          ansible_host: "{{ lookup('pipe', 'grep ^CADDY_IP= ../../.env | cut -d= -f2') | default('192.168.1.11', true) }}"
          ansible_user: root
          ansible_connection: ssh
          lxc_id: 101
          lxc_template: debian-12-standard
          lxc_storage: local-lvm
          lxc_memory: 512
          lxc_cores: 1
          lxc_disk_size: 4

        tailscale:
          ansible_host: "{{ lookup('pipe', 'grep ^TAILSCALE_IP= ../../.env | cut -d= -f2') | default('192.168.1.12', true) }}"
          ansible_user: root
          ansible_connection: ssh
          lxc_id: 102
          lxc_template: debian-13-standard
          lxc_storage: local-lvm
          lxc_memory: 128
          lxc_cores: 1
          lxc_disk_size: 2
          lxc_privileged: true  # Required for TUN device access

    docker_hosts:
      hosts:
        docker-services:
          ansible_host: "{{ lookup('pipe', 'grep ^DOCKER_HOST_IP= ../../.env | cut -d= -f2') | default('192.168.1.50', true) }}"
          ansible_user: root
          ansible_connection: ssh
          vm_id: 200
          vm_memory: 14336  # 14 GB max - increased for Arr stack
          vm_balloon: 4096  # Minimum RAM (4 GB) - can balloon up to vm_memory
          vm_cores: 4
          vm_disk_size: 50
          vm_template: ubuntu-22.04-server

    game_servers:
      hosts:
        game-server:
          ansible_host: "{{ lookup('pipe', 'grep ^GAME_SERVER_IP= ../../.env | cut -d= -f2') | default('192.168.1.51', true) }}"
          ansible_user: root
          ansible_connection: ssh
          vm_id: 202
          vm_memory: 14336  # 14 GB max - for Satisfactory and other games
          vm_balloon: 4096  # Minimum RAM (4 GB) - can balloon up to vm_memory
          vm_cores: 4
          vm_disk_size: 50
          vm_template: ubuntu-22.04-server
          vm_start_on_boot: false  # OFF by default - start manually when gaming

    nas:
      hosts:
        truenas:
          ansible_host: "{{ lookup('pipe', 'grep ^TRUENAS_IP= ../../.env | cut -d= -f2') | default('192.168.1.60', true) }}"
          ansible_user: admin
          ansible_connection: ssh
          ansible_become: true
          ansible_become_method: sudo
